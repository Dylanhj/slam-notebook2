#3.1旋转矩阵
##3.1.1点、向量和坐标系
任意向量a在一组基下面的坐标：
$$a=[e_1,e_2,e_3]\left[
   \begin{matrix}
     a_1 \\
     a_2 \\
     a_3 \\
   \end{matrix}
  \right] =a_1e_1+a_2e_2+a_3e_3
$$
##3.1.2坐标系之间的欧式转换
刚体运动由一个平移和旋转组成
用一个矩阵描述旋转，称为旋转矩阵（是行列式为1的正交矩阵）
##3.1.3变换矩阵与齐次方程
通过向量末尾加一升维，变为齐次坐标，将平移和旋转写进一个矩阵中，称为变化矩阵
#3.3旋转向量和欧拉角
##3.3.1旋转向量
$$\theta = arccos \frac{tr(R)-1}{2}$$
$tr(R)$为取矩阵对角线元素之和
##3.3.2欧拉角
1.绕物体的Z轴旋转得到偏航角yaw
2.绕**旋转后**的Y轴旋转得到俯仰角pitch
3.绕**旋转后**的X轴旋转得到滚转角roll
- 一般使用rpy角，其顺序为ZYX
- 万向锁问题导致其不适合插值和迭代，一般仅用于人机交互
#3.4四元数
##3.4.1四元数的定义
想要将复平面的向量旋转$\theta$角，就可以给复向量乘以$e^{i\theta}$。使用欧拉公式表示为：
$$e^{i\theta}=cos\theta + isin\theta$$
使用单位四元数表示三维空间的旋转
一个四元数由一个实部和三个虚部组成：
$$q=q_0+q_1i+q_2j+q_3k$$
三个虚部满足以下几个条件：
$$
\begin{cases}
i^2 = j^2=k^2=-1 \\
ij=k,ji=-k \\
jk =i,kj=-1 \\
ji=j,ik=-j
\end{cases}$$
##3.4.2四元数的运算
$$q_a=[s_a,v_a]^T,q_b=[s_b,v_b]^T$$
$$q_a\pm q_b = [s_a \pm s_b,v_a \pm v_b]^T$$
$$q_aq_b=[a_aa_b-v_a^Tv_b,s_av_b+s_bv_a+v_a \times v_b]^T$$
$$||q_a||=\sqrt{s_a^2+x_a^2+y_a^2+z_a^2}$$
$$||q_aq_b||=||q_a||||q_b||$$
$$q_a^* =[s_a,-V_a]^T$$
$$q^*q = qq^* = [s_a^2+v^Tv,0]^T$$
$$q^{-1}=q^*/||q||^2$$
$$(q_aq_b)^{-1}=q_b^{-1}q_a^{-1}$$
$$kq=[ks,kv]^T$$
##3.4.3用四元数表示旋转
把三维空间用一个虚四元数表示
$$p = [0,v]^T$$
$$p\prime =q pq^{-1}$$
##3.4.3四元数到其他旋转表示的转换
$$R = vv^T+s^2I=2s v^{\wedge}+(v^{\wedge})^2$$
$$
\begin {cases}
\theta = 2arccosq_0 \\
[n_x,n_y,n_z]^T = [q_1,q_2.q_3]^T/sin \frac{\theta}{2}
\end {cases}
$$


